# ã€Šæ·±åº¦å­¦ä¹ å…¥é—¨ï¼šåŸºäºPythonçš„ç†è®ºä¸å®ç°ã€‹

[TOC]

**Link**ï¼šhttp://www.ituring.com.cn/book/1921

<img src="./assets/image-20251018205707810.png" alt="image-20251018205707810" style="zoom:5%;" />

**è¡¨è¿°è§„åˆ™**

<img src="./assets/image-20251019023611235.png" alt="image-20251019023611235" style="zoom: 33%;" />

## ç¬¬1ç«  Pythonå…¥é—¨

### 1.1 Pythonæ˜¯ä»€ä¹ˆ

reading...

### 1.2 Pythonçš„å®‰è£…

è€ƒè™‘createä¸€ä¸ªé€šç”¨çš„å­¦ä¹ ç¯å¢ƒ

ç»¼åˆå¯¹æ¯”studyã€researchã€learnã€testã€mainã€playç­‰åç§°ï¼Œæœ€ç»ˆé€‰ç”¨**lab**ã€‚



ç›®å‰æœ€æ–°Pythonç‰ˆæœ¬ä¸º3.13ï¼Œè€ƒè™‘åˆ°å…¼å®¹æ€§ï¼Œé€‰æ‹©3.12ç‰ˆæœ¬

`conda create --name lab python=3.12`

é‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œè®¾ç½®USTCé•œåƒæºé‡æ–°å®‰è£…

<img src="./assets/image-20251018233403818.png" alt="image-20251018233403818" style="zoom:25%;" />

### 1.3 Pythonè§£é‡Šå™¨

coding...

å…³é—­Pythonè§£é‡Šå™¨ï¼šWindowsï¼šCtrl-Z  + Enter

### 1.4 Pythonè„šæœ¬æ–‡ä»¶

è€ƒè™‘ç›®å½•ç»“æ„ï¼š

- ç« èŠ‚ä¼˜å…ˆï¼š/ch1/code

- **ç±»å‹ä¼˜å…ˆ**ï¼š/code/ch1

### 1.5 Numpy

coding...

å¹¿æ’­æ˜¯é€šè¿‡æ‰©å±•å®ç°å½¢çŠ¶å®ç°çš„

ç†è§£ä»¥ä¸‹ä»£ç 

```python
A = np.array([1, 2], [3, 4])
B = np.array([10, 20])
A * B
```

```python
X[X > 15]
```

### 1.6 Matplotlib

coding...

## ç¬¬2ç«  æ„ŸçŸ¥æœº

### 2.1 æ„ŸçŸ¥æœºæ˜¯ä»€ä¹ˆ

reading...

### 2.2 ç®€å•é€»è¾‘ç”µè·¯

reading...

### 2.3 æ„ŸçŸ¥æœºçš„å®ç°

coding...

`x = np.array(x1, x2)`âŒ

`x = np.array((x1, x2))`âœ”

`x = np.array([x1, x2])`âœ”

### 2.4 æ„ŸçŸ¥æœºçš„å±€é™æ€§

ä¸Šè¿°æ„ŸçŸ¥æœºå¯ç†è§£ä¸ºç”¨ä¸€æ¡ç›´çº¿åˆ†å‰²äºŒç»´å¹³é¢ï¼Œå› æ­¤æ— æ³•å®ç°å¼‚æˆ–é—¨

### 2.5 å¤šå±‚æ„ŸçŸ¥æœº

å•å±‚æ„ŸçŸ¥æœºæ— æ³•åˆ†ç¦»çº¿æ€§ç©ºé—´

```python
def XOR(x1, x2):
    s1 = NAND(x1, x2)
    s2 = OR(x1, x2)
    y = AND(s1, s2)
    return y
```

### 2.6 ä»ä¸éé—¨åˆ°è®¡ç®—æœº

reading...

## ç¬¬3ç«  ç¥ç»ç½‘ç»œ

### 3.1 ä»æ„ŸçŸ¥æœºåˆ°ç¥ç»ç½‘ç»œ

reading...

### 3.2 æ¿€æ´»å‡½æ•°

ä¹¦ä¸­ `np.int` å·²è¢«å¼ƒç”¨

`np.int_` ä¸ºæ›´æ¨èçš„ç”¨æ³•

```python
def step_function(x):
    y = x > 0
    return y.astype(np.int_)
```



ä¹¦ä¸­ `import matplotlib.pylab as plt`

æ¨è `import matplotlib.pyplot as plt`



pythonä¸­ç›´æ¥å†™`plt.show`ï¼ˆæ²¡åŠ ()ï¼‰ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œè¡¨ç¤ºå‡½æ•°å¼•ç”¨ï¼Œåªæœ‰åŠ ()æ‰è¡¨ç¤ºå‡½æ•°è°ƒç”¨



ä¸ºä»€ä¹ˆpythonä¸­è¿ç®—ç¬¦å¯ä»¥ç›´æ¥å‚ä¸np.arrayè¿ç®—ï¼Œä½†æ˜¯è‡ªå®šä¹‰å‡½æ•°ä¸è¡Œï¼Ÿ

- **è¿ç®—ç¬¦**èƒ½å·¥ä½œæ˜¯å› ä¸ºNumPyé‡è½½äº†å®ƒä»¬
- **è‡ªå®šä¹‰å‡½æ•°**éœ€è¦æ˜¾å¼ä½¿ç”¨NumPyå‡½æ•°æˆ–`np.vectorize`æ¥è·å¾—ç›¸åŒçš„è¡Œä¸º
- æˆ–ç¡®ä¿å‡½æ•°æ”¯æŒæ•°ç»„è¿ç®—
- æœ€ä½³å®è·µæ˜¯åœ¨è‡ªå®šä¹‰å‡½æ•°ä¸­**ä½¿ç”¨NumPyå‡½æ•°**è€Œä¸æ˜¯Pythonå†…ç½®æ“ä½œç¬¦



- `np.max(0, x)`ï¼šé”™è¯¯ç”¨æ³•ï¼Œ`np.max()` ç”¨äºæ‰¾æ•°ç»„ä¸­çš„æœ€å¤§å€¼
- `np.maximum(0, x)`ï¼šæ­£ç¡®ç”¨æ³•ï¼Œé€å…ƒç´ æ¯”è¾ƒä¸¤ä¸ªè¾“å…¥ï¼Œè¿”å›æ¯ä¸ªä½ç½®çš„æœ€å¤§å€¼

### 3.3 å¤šç»´æ•°ç»„çš„è¿ç®—

~~åœ¨NumPyä¸­ï¼Œä¸€ç»´æ•°ç»„å’ŒäºŒç»´æ•°ç»„çš„ä¹˜æ³•è¡Œä¸ºç¡®å®å­˜åœ¨å·®å¼‚ï¼Ÿ~~

- ~~å®é™…ä¸Šï¼Œ`*` è¿ç®—ç¬¦åœ¨NumPyä¸­å¯¹äºä»»ä½•ç»´åº¦çš„æ•°ç»„éƒ½æ˜¯æ‰§è¡Œé€å…ƒç´ ä¹˜æ³•~~
- ~~çœ‹ä¼¼ä¸ä¸€è‡´çš„è¡Œä¸ºï¼Œæ˜¯ç”±äºNumPyçš„å¹¿æ’­æœºåˆ¶~~



ä¸ºä»€ä¹ˆè¿™ä¸ªå¯ä»¥æ­£å¸¸ç®—ï¼ŸXæ˜¯(2,)ï¼ŒWæ˜¯(2, 3)

```python
import numpy as np

X = np.array([1, 2])
print(X.shape)

W = np.array([[1, 3, 5], [2, 4, 6]])
print(W.shape)

Y = np.dot(X, W)
print(Y.shape)
```

`np.dot(a, b)` çš„ç»´åº¦åŒ¹é…è§„åˆ™æ˜¯ï¼š

- **æœ€åä¸€ä¸ªç»´åº¦**çš„ `a` å¿…é¡»ä¸ **ç¬¬ä¸€ä¸ªç»´åº¦** çš„ `b` ç›¸åŒ¹é…

```python
# æƒ…å†µ1ï¼šä¸¤ä¸ªä¸€ç»´æ•°ç»„ â†’ ç‚¹ç§¯ï¼ˆæ ‡é‡ï¼‰
a = np.array([1, 2])
b = np.array([3, 4])
np.dot(a, b)  # 1Ã—3 + 2Ã—4 = 11

# æƒ…å†µ2ï¼šä¸€ç»´ä¸äºŒç»´ â†’ çŸ©é˜µ-å‘é‡ä¹˜æ³•
a = np.array([1, 2])        # (2,)
b = np.array([[1, 3, 5],    # (2, 3)
              [2, 4, 6]])
np.dot(a, b)  # (3,)

# æƒ…å†µ3ï¼šä¸¤ä¸ªäºŒç»´æ•°ç»„ â†’ çŸ©é˜µä¹˜æ³•
a = np.array([[1, 2]])      # (1, 2)
b = np.array([[1, 3, 5],    # (2, 3)
              [2, 4, 6]])
np.dot(a, b)  # (1, 3)
```

### 3.4 3å±‚ç¥ç»ç½‘è·¯çš„å®ç°

coding...

### 3.5 è¾“å‡ºå±‚çš„è®¾è®¡

æ³¨æ„ï¼š

è¯¥å‡½æ•°åœ¨aå­˜åœ¨è¾ƒå¤§å…ƒç´ æ—¶ä¼šå‡ºé”™nan

```python
def softmax(a):
    y = np.exp(a) / np.sum(np.exp(a))
    return y
```

æ”¹ä¸º

```python
def softmax(a):
    c = np.max(a)
    return np.exp(a - c) / np.sum(np.exp(a - c))
```

### 3.6æ‰‹å†™æ•°å­—è¯†åˆ«

PIL = Python Imaging Libraryï¼ˆPython å›¾åƒå¤„ç†åº“ï¼‰

PIL Image çš„ modeï¼ŒMNIST æ˜¯'L'ï¼ˆç°åº¦ï¼‰

> 
>
> ### âœ… æ€»ç»“
>
> - `from PIL import Image` æ˜¯ Python å¤„ç†å›¾åƒçš„**æ ‡å‡†æ–¹å¼**ï¼ˆå®é™…ç”¨çš„æ˜¯ Pillow åº“ï¼‰
> - **`torchvision` å†…éƒ¨ç”¨ PIL åŠ è½½å›¾åƒ**ï¼Œå†æ ¹æ®ä½ çš„ `transform` å†³å®šæ˜¯å¦è½¬æˆ Tensor
> - ä½ ç°åœ¨ç”¨ `transforms.ToTensor()`ï¼Œæ‰€ä»¥**çœ‹ä¸åˆ° PIL Image**ï¼Œä½†å®ƒåœ¨åº•å±‚é»˜é»˜å·¥ä½œ
> - å¦‚æœä½ ä»¥åè¦å¤„ç†è‡ªå·±çš„å›¾ç‰‡æ•°æ®é›†ï¼Œå°±ä¼šç»å¸¸ç”¨åˆ° `Image.open()`
>
> ğŸ’¡ **å°çŸ¥è¯†**ï¼š
> ä½ ä¹‹å‰é‡åˆ°çš„ `RuntimeError: Numpy is not available`ï¼Œå…¶å®æ˜¯å› ä¸º `torchvision` åœ¨æŠŠ PIL Image è½¬ Tensor æ—¶ï¼Œä¸­é—´ä¼šç»è¿‡ NumPyï¼Œæ‰€ä»¥ NumPy å¿…é¡»å­˜åœ¨ï¼



```python
def init_network():
    network = {}

    # ç¬¬1å±‚
    network['W1'] = np.random.randn(784, 50) * 0.01
    network['b1'] = np.zeros(50)

    # ç¬¬2å±‚
    network['W2'] = np.random.randn(50, 100) * 0.01
    network['b2'] = np.zeros(100)

    # ç¬¬ä¸€å±‚
    network['W3'] = np.random.randn(100, 10) * 0.01
    network['b3'] = np.zeros(10)

    return network
```

ä¸ºä»€ä¹ˆç”¨ `np.random.randn`

- æ‰“ç ´å¯¹ç§°æ€§ï¼šå¦‚æœæ‰€æœ‰æƒé‡éƒ½ä¸€æ ·ï¼ˆæ¯”å¦‚å…¨ 0ï¼‰ï¼Œç¥ç»å…ƒä¼šå­¦ä¸åˆ°ä¸åŒç‰¹å¾ã€‚

- é¿å…æ¿€æ´»å‡½æ•°é¥±å’Œï¼šSigmoid åœ¨è¾“å…¥å¾ˆå¤§æˆ–å¾ˆå°æ—¶æ¢¯åº¦æ¥è¿‘ 0ï¼Œå°æƒé‡è®©è¾“å…¥è½åœ¨æ•æ„ŸåŒºåŸŸã€‚

- æ ‡å‡†åšæ³•ï¼šè¿™æ˜¯æ·±åº¦å­¦ä¹ ä¸­ç»å…¸çš„ â€œå°éšæœºåˆå§‹åŒ–â€ ç­–ç•¥ã€‚



`np.max` ï¼šæœ€å¤§å€¼

`np.argmax` ï¼šæœ€å¤§å€¼ç´¢å¼•



P78ï¼šbatch_size # æ‰¹æ•°é‡

åº”è¯¥æ˜¯æ‰¹å¤§å°



å¿½ç•¥æ‰€æœ‰åä¸º data çš„ç›®å½•ï¼ˆæ— è®ºåœ¨å“ªä¸€çº§ï¼‰

`data/`

åªå¿½ç•¥æ ¹ç›®å½•ä¸‹çš„ data ç›®å½•ï¼š

`/data`

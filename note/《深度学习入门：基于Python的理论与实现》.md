# ã€Šæ·±åº¦å­¦ä¹ å…¥é—¨ï¼šåŸºäºPythonçš„ç†è®ºä¸å®ç°ã€‹

[TOC]

**Link**ï¼šhttp://www.ituring.com.cn/book/1921

<img src="./assets/image-20251018205707810.png" alt="image-20251018205707810" style="zoom:5%;" />

**è¡¨è¿°è§„åˆ™**

<img src="./assets/image-20251019023611235.png" alt="image-20251019023611235" style="zoom: 33%;" />

## ç¬¬1ç«  Pythonå…¥é—¨

### 1.1 Pythonæ˜¯ä»€ä¹ˆ

reading...

### 1.2 Pythonçš„å®‰è£…

è€ƒè™‘createä¸€ä¸ªé€šç”¨çš„å­¦ä¹ ç¯å¢ƒ

ç»¼åˆå¯¹æ¯”studyã€researchã€learnã€testã€mainã€playç­‰åç§°ï¼Œæœ€ç»ˆé€‰ç”¨**lab**ã€‚



ç›®å‰æœ€æ–°Pythonç‰ˆæœ¬ä¸º3.13ï¼Œè€ƒè™‘åˆ°å…¼å®¹æ€§ï¼Œé€‰æ‹©3.12ç‰ˆæœ¬

`conda create --name lab python=3.12`

é‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œè®¾ç½®USTCé•œåƒæºé‡æ–°å®‰è£…

<img src="./assets/image-20251018233403818.png" alt="image-20251018233403818" style="zoom:25%;" />

### 1.3 Pythonè§£é‡Šå™¨

coding...

å…³é—­Pythonè§£é‡Šå™¨ï¼šWindowsï¼šCtrl-Z  + Enter

### 1.4 Pythonè„šæœ¬æ–‡ä»¶

è€ƒè™‘ç›®å½•ç»“æ„ï¼š

- ç« èŠ‚ä¼˜å…ˆï¼š/ch1/code

- **ç±»å‹ä¼˜å…ˆ**ï¼š/code/ch1

### 1.5 Numpy

coding...

å¹¿æ’­æ˜¯é€šè¿‡æ‰©å±•å®ç°å½¢çŠ¶å®ç°çš„

ç†è§£ä»¥ä¸‹ä»£ç 

```python
A = np.array([1, 2], [3, 4])
B = np.array([10, 20])
A * B
```

```python
X[X > 15]
```

### 1.6 Matplotlib

coding...

## ç¬¬2ç«  æ„ŸçŸ¥æœº

### 2.1 æ„ŸçŸ¥æœºæ˜¯ä»€ä¹ˆ

reading...

### 2.2 ç®€å•é€»è¾‘ç”µè·¯

reading...

### 2.3 æ„ŸçŸ¥æœºçš„å®ç°

coding...

`x = np.array(x1, x2)`âŒ

`x = np.array((x1, x2))`âœ”

`x = np.array([x1, x2])`âœ”

### 2.4 æ„ŸçŸ¥æœºçš„å±€é™æ€§

ä¸Šè¿°æ„ŸçŸ¥æœºå¯ç†è§£ä¸ºç”¨ä¸€æ¡ç›´çº¿åˆ†å‰²äºŒç»´å¹³é¢ï¼Œå› æ­¤æ— æ³•å®ç°å¼‚æˆ–é—¨

### 2.5 å¤šå±‚æ„ŸçŸ¥æœº

å•å±‚æ„ŸçŸ¥æœºæ— æ³•åˆ†ç¦»çº¿æ€§ç©ºé—´

```python
def XOR(x1, x2):
    s1 = NAND(x1, x2)
    s2 = OR(x1, x2)
    y = AND(s1, s2)
    return y
```

### 2.6 ä»ä¸éé—¨åˆ°è®¡ç®—æœº

reading...

## ç¬¬3ç«  ç¥ç»ç½‘ç»œ

### 3.1 ä»æ„ŸçŸ¥æœºåˆ°ç¥ç»ç½‘ç»œ

reading...

### 3.2 æ¿€æ´»å‡½æ•°

ä¹¦ä¸­ `np.int` å·²è¢«å¼ƒç”¨

`np.int_` ä¸ºæ›´æ¨èçš„ç”¨æ³•

```python
def step_function(x):
    y = x > 0
    return y.astype(np.int_)
```



ä¹¦ä¸­ `import matplotlib.pylab as plt`

æ¨è `import matplotlib.pyplot as plt`



pythonä¸­ç›´æ¥å†™`plt.show`ï¼ˆæ²¡åŠ ()ï¼‰ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œè¡¨ç¤ºå‡½æ•°å¼•ç”¨ï¼Œåªæœ‰åŠ ()æ‰è¡¨ç¤ºå‡½æ•°è°ƒç”¨



ä¸ºä»€ä¹ˆpythonä¸­è¿ç®—ç¬¦å¯ä»¥ç›´æ¥å‚ä¸np.arrayè¿ç®—ï¼Œä½†æ˜¯è‡ªå®šä¹‰å‡½æ•°ä¸è¡Œï¼Ÿ

- **è¿ç®—ç¬¦**èƒ½å·¥ä½œæ˜¯å› ä¸ºNumPyé‡è½½äº†å®ƒä»¬
- **è‡ªå®šä¹‰å‡½æ•°**éœ€è¦æ˜¾å¼ä½¿ç”¨NumPyå‡½æ•°æˆ–`np.vectorize`æ¥è·å¾—ç›¸åŒçš„è¡Œä¸º
- æˆ–ç¡®ä¿å‡½æ•°æ”¯æŒæ•°ç»„è¿ç®—
- æœ€ä½³å®è·µæ˜¯åœ¨è‡ªå®šä¹‰å‡½æ•°ä¸­**ä½¿ç”¨NumPyå‡½æ•°**è€Œä¸æ˜¯Pythonå†…ç½®æ“ä½œç¬¦



- `np.max(0, x)`ï¼šé”™è¯¯ç”¨æ³•ï¼Œ`np.max()` ç”¨äºæ‰¾æ•°ç»„ä¸­çš„æœ€å¤§å€¼
- `np.maximum(0, x)`ï¼šæ­£ç¡®ç”¨æ³•ï¼Œé€å…ƒç´ æ¯”è¾ƒä¸¤ä¸ªè¾“å…¥ï¼Œè¿”å›æ¯ä¸ªä½ç½®çš„æœ€å¤§å€¼

### 3.3 å¤šç»´æ•°ç»„çš„è¿ç®—

~~åœ¨NumPyä¸­ï¼Œä¸€ç»´æ•°ç»„å’ŒäºŒç»´æ•°ç»„çš„ä¹˜æ³•è¡Œä¸ºç¡®å®å­˜åœ¨å·®å¼‚ï¼Ÿ~~

- ~~å®é™…ä¸Šï¼Œ`*` è¿ç®—ç¬¦åœ¨NumPyä¸­å¯¹äºä»»ä½•ç»´åº¦çš„æ•°ç»„éƒ½æ˜¯æ‰§è¡Œé€å…ƒç´ ä¹˜æ³•~~
- ~~çœ‹ä¼¼ä¸ä¸€è‡´çš„è¡Œä¸ºï¼Œæ˜¯ç”±äºNumPyçš„å¹¿æ’­æœºåˆ¶~~



ä¸ºä»€ä¹ˆè¿™ä¸ªå¯ä»¥æ­£å¸¸ç®—ï¼ŸXæ˜¯(2,)ï¼ŒWæ˜¯(2, 3)

```python
import numpy as np

X = np.array([1, 2])
print(X.shape)

W = np.array([[1, 3, 5], [2, 4, 6]])
print(W.shape)

Y = np.dot(X, W)
print(Y.shape)
```

`np.dot(a, b)` çš„ç»´åº¦åŒ¹é…è§„åˆ™æ˜¯ï¼š

- **æœ€åä¸€ä¸ªç»´åº¦**çš„ `a` å¿…é¡»ä¸ **ç¬¬ä¸€ä¸ªç»´åº¦** çš„ `b` ç›¸åŒ¹é…

```python
# æƒ…å†µ1ï¼šä¸¤ä¸ªä¸€ç»´æ•°ç»„ â†’ ç‚¹ç§¯ï¼ˆæ ‡é‡ï¼‰
a = np.array([1, 2])
b = np.array([3, 4])
np.dot(a, b)  # 1Ã—3 + 2Ã—4 = 11

# æƒ…å†µ2ï¼šä¸€ç»´ä¸äºŒç»´ â†’ çŸ©é˜µ-å‘é‡ä¹˜æ³•
a = np.array([1, 2])        # (2,)
b = np.array([[1, 3, 5],    # (2, 3)
              [2, 4, 6]])
np.dot(a, b)  # (3,)

# æƒ…å†µ3ï¼šä¸¤ä¸ªäºŒç»´æ•°ç»„ â†’ çŸ©é˜µä¹˜æ³•
a = np.array([[1, 2]])      # (1, 2)
b = np.array([[1, 3, 5],    # (2, 3)
              [2, 4, 6]])
np.dot(a, b)  # (1, 3)
```

### 3.4 3å±‚ç¥ç»ç½‘è·¯çš„å®ç°

coding...

### 3.5 è¾“å‡ºå±‚çš„è®¾è®¡

æ³¨æ„ï¼š

è¯¥å‡½æ•°åœ¨aå­˜åœ¨è¾ƒå¤§å…ƒç´ æ—¶ä¼šå‡ºé”™nan

```python
def softmax(a):
    y = np.exp(a) / np.sum(np.exp(a))
    return y
```

æ”¹ä¸º

```python
def softmax(a):
    c = np.max(a)
    return np.exp(a - c) / np.sum(np.exp(a - c))
```

### 3.6æ‰‹å†™æ•°å­—è¯†åˆ«

PIL = Python Imaging Libraryï¼ˆPython å›¾åƒå¤„ç†åº“ï¼‰

PIL Image çš„ modeï¼ŒMNIST æ˜¯'L'ï¼ˆç°åº¦ï¼‰

> 
>
> ### âœ… æ€»ç»“
>
> - `from PIL import Image` æ˜¯ Python å¤„ç†å›¾åƒçš„**æ ‡å‡†æ–¹å¼**ï¼ˆå®é™…ç”¨çš„æ˜¯ Pillow åº“ï¼‰
> - **`torchvision` å†…éƒ¨ç”¨ PIL åŠ è½½å›¾åƒ**ï¼Œå†æ ¹æ®ä½ çš„ `transform` å†³å®šæ˜¯å¦è½¬æˆ Tensor
> - ä½ ç°åœ¨ç”¨ `transforms.ToTensor()`ï¼Œæ‰€ä»¥**çœ‹ä¸åˆ° PIL Image**ï¼Œä½†å®ƒåœ¨åº•å±‚é»˜é»˜å·¥ä½œ
> - å¦‚æœä½ ä»¥åè¦å¤„ç†è‡ªå·±çš„å›¾ç‰‡æ•°æ®é›†ï¼Œå°±ä¼šç»å¸¸ç”¨åˆ° `Image.open()`
>
> ğŸ’¡ **å°çŸ¥è¯†**ï¼š
> ä½ ä¹‹å‰é‡åˆ°çš„ `RuntimeError: Numpy is not available`ï¼Œå…¶å®æ˜¯å› ä¸º `torchvision` åœ¨æŠŠ PIL Image è½¬ Tensor æ—¶ï¼Œä¸­é—´ä¼šç»è¿‡ NumPyï¼Œæ‰€ä»¥ NumPy å¿…é¡»å­˜åœ¨ï¼



```python
def init_network():
    network = {}

    # ç¬¬1å±‚
    network['W1'] = np.random.randn(784, 50) * 0.01
    network['b1'] = np.zeros(50)

    # ç¬¬2å±‚
    network['W2'] = np.random.randn(50, 100) * 0.01
    network['b2'] = np.zeros(100)

    # ç¬¬ä¸€å±‚
    network['W3'] = np.random.randn(100, 10) * 0.01
    network['b3'] = np.zeros(10)

    return network
```

ä¸ºä»€ä¹ˆç”¨ `np.random.randn`

- æ‰“ç ´å¯¹ç§°æ€§ï¼šå¦‚æœæ‰€æœ‰æƒé‡éƒ½ä¸€æ ·ï¼ˆæ¯”å¦‚å…¨ 0ï¼‰ï¼Œç¥ç»å…ƒä¼šå­¦ä¸åˆ°ä¸åŒç‰¹å¾ã€‚

- é¿å…æ¿€æ´»å‡½æ•°é¥±å’Œï¼šSigmoid åœ¨è¾“å…¥å¾ˆå¤§æˆ–å¾ˆå°æ—¶æ¢¯åº¦æ¥è¿‘ 0ï¼Œå°æƒé‡è®©è¾“å…¥è½åœ¨æ•æ„ŸåŒºåŸŸã€‚

- æ ‡å‡†åšæ³•ï¼šè¿™æ˜¯æ·±åº¦å­¦ä¹ ä¸­ç»å…¸çš„ â€œå°éšæœºåˆå§‹åŒ–â€ ç­–ç•¥ã€‚



`np.max` ï¼šæœ€å¤§å€¼

`np.argmax` ï¼šæœ€å¤§å€¼ç´¢å¼•



P78ï¼šbatch_size # æ‰¹æ•°é‡

åº”è¯¥æ˜¯æ‰¹å¤§å°



å¿½ç•¥æ‰€æœ‰åä¸º data çš„ç›®å½•ï¼ˆæ— è®ºåœ¨å“ªä¸€çº§ï¼‰

`data/`

åªå¿½ç•¥æ ¹ç›®å½•ä¸‹çš„ data ç›®å½•ï¼š

`/data`





## ç¬¬4ç«  ç¥ç»ç½‘ç»œçš„å­¦ä¹ 

### 4.1 ä»æ•°æ®ä¸­å­¦ä¹ 

reading...

### 4.2 æŸå¤±å‡½æ•°

coding...

### 4.3 æ•°å€¼å¾®åˆ†

```python
def numerical_diff(f, x):
    h = 1e-4
    return (f(x + h) - f(x - h)) / (2 * h)
```

### 4.4 æ¢¯åº¦

ç”±å…¨éƒ¨å˜é‡çš„åå¯¼æ•°æ±‡æ€»è€Œæˆçš„å‘é‡ç§°ä¸ºæ¢¯åº¦ï¼ˆgradientï¼‰

```python
def numerical_gradient(f, x):
    h = 1e-4
    grad = np.zeros_like(x)  # ç”Ÿæˆå’Œ x å½¢çŠ¶ç›¸åŒçš„æ•°ç»„

    for idx in range(x.size):
        tmp_val = x[idx]

        x[idx] = tmp_val + h
        fxh1 = f(x)

        x[idx] = tmp_val - h
        fxh2 = f(x)

        grad[idx] = (fxh1 - fxh2) / (2 * h)

        x[idx] = tmp_val
    
    return grad
```

è¿™é‡Œä¸èƒ½ä½¿ç”¨æ•´æ•°

<img src="./assets/image-20251028233041589.png" alt="image-20251028233041589"  />

<img src="./assets/image-20251028233124342.png" alt="image-20251028233124342" style="zoom:50%;" />





bugï¼šè¿™ä¿©ä¸ºä»€ä¹ˆä¼šç›¸åŒå•Šï¼Ÿ

<img src="./assets/image-20251028234443903.png" alt="image-20251028234443903" style="zoom:50%;" />

å› ä¸ºæ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¼šæ”¹å˜ `init_x` çš„å€¼

<img src="./assets/image-20251028234517792.png" alt="image-20251028234517792" style="zoom: 50%;" />



è¿™é‡Œæ¢¯åº¦ä¸èƒ½è¿™ä¹ˆå®ç°ï¼Œå¦‚æœxæ˜¯äºŒç»´æ•°ç»„ä¼šæŠ¥é”™

![image-20251101213312148](./assets/image-20251101213312148.png)

![image-20251101220020175](./assets/image-20251101220020175.png)

### 4.5 å­¦ä¹ ç®—æ³•çš„å®ç°

è¿™é‡Œè­¦å‘Šæ˜¯ç”±äºé™æ€æ£€è½¦æ— æ³•æ­£ç¡®è¯†åˆ«x_trainç±»å‹ï¼Œæ¨èæ”¶é›†æ•°æ®æ—¶ä¸è¦ç”¨ç›¸åŒå˜é‡åï¼Œä¾‹å¦‚ `x_train_list`

![image-20251101231949930](./assets/image-20251101231949930.png)

reshapeæœ¬èº«ä¸ä¿®æ”¹å½¢çŠ¶ï¼Œéœ€è¦è¿”å›æ–°çš„å…ƒç´ 

![image-20251101232503676](./assets/image-20251101232503676.png)

å™ªå£°å¤ªå¤§æ²¡æœ‰æ„ä¹‰ï¼Œè€Œä¸”ä¹Ÿå¤ªæ…¢äº†

![image-20251102020401996](./assets/image-20251102020401996.png)

è¿™é‡Œå–ç¬¬ä¸€ä¸ªæ•°æ®è¿›è¡Œæµ‹è¯•

![image-20251102021742946](./assets/image-20251102021742946.png)

![image-20251102022354988](./assets/image-20251102022354988.png)

ä»¥ä¸‹æ˜¯å®Œæ•´çš„è¿­ä»£è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹å‡º

```python
epoch: 0
sofymax: [1.20833628e-07 5.85717628e-03 1.22631110e-06 1.36769664e-05
 9.33650974e-03 6.67757555e-06 2.83617497e-10 1.84447304e-10
 6.59093547e-06 9.84778021e-01]
y: 9
loss: 11.916755577788203
epoch: 1
sofymax: [2.18810743e-07 2.02220274e-02 2.45072080e-06 4.65783482e-05
 2.43778393e-02 6.73709167e-05 1.12091958e-09 5.57739972e-10
 1.25211512e-05 9.55270992e-01]
y: 9
loss: 9.60529713639048
epoch: 2
sofymax: [3.90446550e-07 6.34143433e-02 4.60947797e-06 1.52384357e-04
 5.57100343e-02 5.94327114e-04 4.05464223e-09 1.60742079e-09
 2.30377729e-05 8.80100868e-01]
y: 9
loss: 7.428080692546942
epoch: 3
sofymax: [6.51319350e-07 1.54253693e-01 7.56761995e-06 4.12824604e-04
 9.98098157e-02 4.02023834e-03 1.12893095e-08 3.97889745e-09
 3.89498830e-05 7.41456244e-01]
y: 9
loss: 5.516414088331097
epoch: 4
sofymax: [9.94942190e-07 2.70992340e-01 1.06350644e-05 8.79995511e-04
 1.34454113e-01 2.06341951e-02 2.31071596e-08 8.21316357e-09
 5.85884147e-05 5.72969106e-01]
y: 9
loss: 3.8808056223823644
epoch: 5
sofymax: [1.41535367e-06 3.51612682e-01 1.31626709e-05 1.53904306e-03
 1.42734446e-01 8.53167512e-02 3.71381484e-08 1.47025916e-08
 7.90250497e-05 4.18703423e-01]
y: 9
loss: 2.461384464179898
epoch: 6
sofymax: [1.74823042e-06 3.33394459e-01 1.37250255e-05 2.13465365e-03
 1.21247168e-01 2.63223184e-01 4.71306422e-08 2.16509441e-08
 8.98302059e-05 2.79895164e-01]
y: 1
loss: 1.3347529998336007
epoch: 7
sofymax: [1.69345907e-06 2.37674860e-01 1.14629523e-05 2.19052165e-03
 8.44158207e-02 5.06039690e-01 4.56752505e-08 2.36659928e-08
 8.02342003e-05 1.69585647e-01]
y: 5
loss: 0.6811401731690229
epoch: 8
sofymax: [1.44664537e-06 1.61707692e-01 8.90828130e-06 1.92828493e-03
 5.79457183e-02 6.69853046e-01 3.91510905e-08 2.17418484e-08
 6.49781517e-05 1.08489865e-01]
y: 5
loss: 0.40069692533780593
epoch: 9
sofymax: [1.23248520e-06 1.18349537e-01 7.16601312e-06 1.67506827e-03
 4.28870880e-02 7.59704050e-01 3.35721551e-08 1.93912451e-08
 5.36109410e-05 7.73221935e-02]
y: 5
loss: 0.2748263287780079
```

è¿è¡Œæ—¶é—´å¤ªä¹…äº†ï¼Œå°è¯•æ¨¡å‹ç¼©å°10å€

![image-20251102023224892](./assets/image-20251102023224892.png)

è™½ç„¶æ—¶é—´å¿«äº†ï¼Œä½†æ˜¯æ”¶æ•›é€Ÿåº¦æ…¢äº†å¾ˆå¤šï¼Œæ¨¡å‹å­¦ä¸åŠ¨äº†ï¼Ÿ

![image-20251102023359283](./assets/image-20251102023359283.png)

çœ‹æ¥è¿˜æ˜¯ç»ƒçš„åŠ¨çš„ï¼Œæ¯•ç«Ÿåªæœ‰ä¸€å¼ å›¾ï¼Œä¸å­˜åœ¨æ•°æ®å™ªå£°ï¼Œä¹Ÿå°±ä¸å­˜åœ¨æ¬ æ‹Ÿåˆ

![image-20251102023953764](./assets/image-20251102023953764.png)

çªç„¶æƒ³èµ·æ¥è¿˜æœ‰ä¸ªreluå‡½æ•°æ›´å¿«

![image-20251102024625027](./assets/image-20251102024625027.png)

![image-20251102024614035](./assets/image-20251102024614035.png)

å†è¯•ä¸€ä¸‹ä¸€å¼€å§‹100å±‚çš„æ¨¡å‹

![image-20251102144316057](./assets/image-20251102144316057.png)

å¯ä»¥çœ‹åˆ°æ”¶æ•›é€Ÿåº¦å¿«äº†ä¸æ˜¯ä¸€ç‚¹ï¼Œä¸€ä¸ªephoå°±æ”¶æ•›äº†

![image-20251102150022102](./assets/image-20251102150022102.png)

éœ€è¦å…¼å®¹å¤šç»´æ•°ç»„

ä¸è¿‡è¿™é‡Œ `predict` ç«Ÿç„¶ä¸ç”¨æ”¹ï¼Ÿ

sigmoidå’Œsoftmaxæ˜¯å¦éœ€è¦ä¿®æ”¹ï¼Ÿ

> ### âœ… 1. **Sigmoidï¼šå¤©ç„¶æ”¯æŒå¤šç»´ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰**
>
> - **æ•°å­¦å®šä¹‰**ï¼š
>   *Ïƒ*(*z*)=1+*e*âˆ’*z*1â€‹
>
> - **æ“ä½œæ€§è´¨**ï¼š**é€å…ƒç´ **ï¼ˆelement-wiseï¼‰å‡½æ•°
>
> - **NumPy è¡Œä¸º**ï¼š
>   å¯¹ä»»æ„å½¢çŠ¶çš„æ•°ç»„ï¼ˆ1Dã€2Dã€3D...ï¼‰ï¼Œ`np.exp(-a)` å’Œé™¤æ³•éƒ½ä¼šè‡ªåŠ¨å¹¿æ’­ï¼ˆbroadcastï¼‰ï¼Œ**å¯¹æ¯ä¸ªå…ƒç´ ç‹¬ç«‹è®¡ç®—**ã€‚
>
> - **ç»“è®º**ï¼š
>
>   > âœ… ä½ çš„åŸå§‹ `sigmoid` å‡½æ•° **æ— éœ€ä»»ä½•ä¿®æ”¹**ï¼Œå³å¯æ­£ç¡®å¤„ç†æ‰¹é‡è¾“å…¥ï¼ˆå¦‚ `(N, D)`ï¼‰ã€‚ 
>
> def sigmoid(a):
>
> â€‹    return 1 / (1 + np.exp(-a))  # å¯¹ (N, D) è¾“å…¥ï¼Œè¾“å‡º (N, D)ï¼Œæ¯ä¸ªå…ƒç´ ç‹¬ç«‹è®¡ç®—
>
> ### âœ… 2. **Softmaxï¼šå¿…é¡»æ˜¾å¼æŒ‰â€œè¡Œâ€å½’ä¸€åŒ–ï¼ˆå¿…é¡»ä¿®æ”¹ï¼‰**
>
> - **æ•°å­¦å®šä¹‰**ï¼ˆå¯¹å•ä¸ªæ ·æœ¬ï¼‰ï¼š
>   softmax(*z*)*i*â€‹=âˆ‘*j*â€‹*e**z**j*â€‹*e**z**i*â€‹â€‹
> - **å…³é”®ç‚¹**ï¼šåˆ†æ¯æ˜¯**åŒä¸€è¾“å…¥æ ·æœ¬æ‰€æœ‰ç±»åˆ«çš„æŒ‡æ•°å’Œ**ï¼ˆå³å¯¹â€œç±»åˆ«ç»´åº¦â€å½’ä¸€åŒ–ï¼‰
> - **æ‰¹é‡è¾“å…¥æ—¶**ï¼š
>   - è¾“å…¥å½¢çŠ¶ï¼š`(N, C)`ï¼ˆN ä¸ªæ ·æœ¬ï¼ŒC ä¸ªç±»åˆ«ï¼‰
>   - **å¿…é¡»å¯¹æ¯ä¸€è¡Œ**ï¼ˆæ¯ä¸ªæ ·æœ¬ï¼‰ï¼š`axis=1`
> - **ä¸ä¿®æ”¹çš„åæœ**ï¼š
>   - è‹¥ç›´æ¥ç”¨ `np.sum(np.exp(a))`ï¼ˆæ—  `axis` å‚æ•°ï¼‰ï¼š
>     - åˆ†æ¯ = **æ•´ä¸ª batch æ‰€æœ‰å…ƒç´ çš„å’Œ**
>     - ç»“æœï¼šæ¯ä¸ªæ ·æœ¬çš„ softmax è¢«æ•´ä¸ª batch çš„æ•°æ®â€œæ±¡æŸ“â€
>     - **è¾“å‡ºä¸æ˜¯åˆæ³•çš„æ¦‚ç‡åˆ†å¸ƒ**ï¼ˆæ¯è¡Œå’Œ â‰  1ï¼‰

pythonå¹¿æ’­æœºåˆ¶ä»å³å‘å·¦å¯¹é½ï¼Œç›´æ¥å¯¹axisæ±‚å’Œå¯¼è‡´ç¬¬2ç»´æ¶ˆå¤±ï¼Œåˆ™sçš„axis0ç»´ä»å³å‘å·¦ä¸açš„axis=1å¯¹é½ï¼Œä¸æ˜¯softmaxå¸Œæœ›çš„ç»“æœ

ä½¿ç”¨ `keepdims` ä½¿å¾—axis=1ç»´åº¦ä¸ä¼šæ¶ˆå¤±ï¼Œä»è€Œå¹¿æ’­æœºåˆ¶ä¸å‹ç¼©å‰ç›¸åŒ

ä»¥æ­¤ç±»æ¨ï¼Œä½¿ç”¨æ­¤å‚æ•°å¯ä»¥å¯¹ä»»æ„æŸç»´åº¦æ“ä½œï¼Œä¸”åç»­å¹¿æ’­æ—¶æ¢å¤åŸæ¥çš„å½¢çŠ¶

![image-20251102155423730](./assets/image-20251102155423730.png)

æ”¯æŒbatchå¤„ç†åå•æ ·æœ¬åˆè®­ç»ƒä¸äº†äº†

![image-20251102161508292](./assets/image-20251102161508292.png)

ç»ˆäºå•æ ·æœ¬å’Œbatchéƒ½é€šäº†

![image-20251102163045862](./assets/image-20251102163045862.png)

è¯¶ï¼Œä¸ºä»€ä¹ˆæŸå¤±æ˜¯è´Ÿçš„ï¼Ÿ

losså‡½æ•°æ²¡é”™ï¼Œé‚£å°±è¯´æ˜æ˜¯softmaxå‡½æ•°é”™äº†

![image-20251102163213607](./assets/image-20251102163213607.png)

æ”¹æˆæ•°å€¼ç¨³å®šç‰ˆåå¿˜äº†æ”¹a...



ä»¥batch_size = 10è®­ç»ƒï¼Œæ”¶æ•›å¾ˆæ…¢

![image-20251102171438636](./assets/image-20251102171438636.png)



SGD mini-batchå®ç°

![image-20251102180133382](./assets/image-20251102180133382.png)

è®­ç»ƒå¤ªæ…¢äº†ï¼Œè¿™é‡Œå–10æ¬¡ä¸ºä¾‹

![image-20251102180215410](./assets/image-20251102180215410.png)

